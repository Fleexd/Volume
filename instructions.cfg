Instructions

https://github.com/frgnca/AudioDeviceCmdlets

1. Import Cmdlet to PowerShell

	Download https://github.com/frgnca/AudioDeviceCmdlets/releases/download/v3.0/AudioDeviceCmdlets.dll


	New-Item "$($profile | split-path)\Modules\AudioDeviceCmdlets" -Type directory -Force
	
-------------> Add the location of the dll file here
	Copy-Item "C:\Temp\AudioDeviceCmdlets.dll" "$($profile | split-path)\Modules\AudioDeviceCmdlets\AudioDeviceCmdlets.dll"
	
	Set-Location "$($profile | Split-Path)\Modules\AudioDeviceCmdlets"
	
	Get-ChildItem | Unblock-File
	
	Import-Module AudioDeviceCmdlets
	
	
2. Run the kiwi.ps1 with powershell on admin rights.

	.\kiwi.ps1
	
3. Open index.txt on your desktop and search for the Index number corresponding to the speaker and microphone

	
4. Run the felix.ps1 with Powershell on admin rights.
	
	.\felix.ps1

5. Done!


-- Windows scheduler setup is needed to get the script running every time a user logs on. --


Error reports will be sent directly to the local admin. The local admin will be notified and he will be fixing the problem shortly.


Selfservice

If you have some knowledge in prior powershell or programming experience the error report should be easy to dig through. 
Here we have an example on how the error report could look like.

	Index   : 1
	Default : True
	Type    : Playback
	Name    : Speakers (4- High Definition Audio Device)
	ID      : {0.0.0.00000000}.{55d45e48-8c5b-42f4-8716-a7c0140583c3}
	Device  : CoreAudioApi.MMDevice
	
	PS H:\> Set-Audiodevice -index <string> 
	At line:1
	char:21 + Set-Audiodevice -index <string> 
	+                     ~ The '<' operator is reserved for future use. 
	At line:1 char:21
	+ Set-Audiodevice -index <string>
	+                     ~ The '<' operator is reserved for future use.
	+ CategoryInfo          : ParserError: (:) [], ParentContainsError    RecordException
	+ FullyQualifiedErrorId : RedirectionNotSupported
	
	PS H:\> stop-Transcript 
	
	********************** 
	Windows PowerShell 
	transcript end End time: 20190308094724 
	**********************
	
	
In this error we see that the operator of the computer has not replaced the <string> with the corresponding index number
 with the speakers that should be used.